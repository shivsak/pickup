<html>
<head>
  <meta charset="utf-8">
  <title>Pickup</title>
  <meta name="description" content="Pickup">
  <meta name="viewport" content="width=1000px, initial-scale=0.4, maximum-scale=1, minimum-scale=0.4">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>

</head>
<body>
  <div id="navbar" style="background:rgba(20,20,20,0); padding: 10px;">

    <i class="icon circle huge left floated inverted white" style="position: absolute; left: 10px; top: 0px;"></i>

      <!-- <a href="/users/sign_up" class="ui basic button inverted right floated" style="margin-right: 15px;">Sign Up</a> -->
      <div id="navbar" style="background:rgba(20,20,20,0); padding: 10px;">
        <% if !person_signed_in? %>
          <a href="/people/sign_in" class="ui basic button inverted right floated" style="margin-right: 15px;">Sign In</a>
          <a href="/people/sign_up" class="ui basic button inverted right floated" style="margin-right: 15px;">Sign Up</a>
        <% else %>
          <div class="ui dropdown basic button inverted right floated">
            <div class="text"><i class="icon user"></i><%= current_person.email %><i class="dropdown icon"></i></div>
            <div class="menu">
              <%= link_to "Sign Out", destroy_person_session_path, method: :delete, :class => 'item'  %>
              <%= link_to 'Change Password', edit_person_registration_path, :class => 'item' %>
            </div>
          </div>
        <% end %>
      </div>

    </p>
  </div>

  <br /><br /><br />
  <div class="container limited">
  <h1>All Games</h1>
  <a href="ui button">Button</a>

    <div class="ui text stackable menu">
          <div class="ui basic <% if !params[:sort].blank? %> blue <% else %>  <% end %> button simple dropdown right floated">
            <div class="text">Sort By<i class="dropdown icon"></i></div><br />
            <div class="menu">
              <%= link_to 'Distance', request.parameters.merge({:sort => 'distance'}), class:
              if params['sort'] == 'distance' then
                'active item'
              else
                'item'
              end %>

              <%= link_to 'Recent', request.parameters.merge({:sort => 'recent'}), class:
              if params['sort'] == 'recent' then
                'active item'
              else
                'item'
              end %>

            </div>
          </div>
          &nbsp;




        <div class="right menu">
          <div class="item">
            <%= link_to request.parameters.merge({:list_type => 'list'}), class:'item' do %>
              <i class="icon list layout large <% if params[:list_type] != "list" %>grey<% else %> black<% end %>"></i>
            <% end %>
            <%= link_to request.parameters.merge({:list_type => 'card'}), class:'item' do %>
              <i class="icon block layout large <% if params[:list_type] != "card" %>grey<% else %> black<% end %>"></i>
            <% end %>
          </div>
          <div class="item">
            <div class="ui icon input">
              <form>
                <input type="text" name="query" placeholder="Search"></input>
                <input type="text" name="low_price" value="<%= params[:low_price] %>" hidden="true"></input>
                <input type="text" name="high_price" value="<%= params[:high_price] %>" hidden="true"></input>
                <input type="text" name="sort" value="<%= params[:sort] %>" hidden="true"></input>
                <input type="text" name="category" value="<%= params[:category] %>" hidden="true"></input>
                <i class="icon search"></i>
                <input type="submit" hidden="true">
              </form>
            </div>
          </div>
        </div>
      </div>
      <br /><br />
      <center>
        <%= link_to new_game_path, class: "ui button green" do %>
          <i class="add icon"></i> New Game
        <% end %>
      </center>
      <br /><br />

      <!-- Cards -->
        <div class="ui three stackable link cards">
          <% @games.each do |game| %>
            <!-- One card per game -->
              <div class="ui card">
                <!-- Content -->
                <div class="image-bg-<%=(game.id.to_i%7).to_s%>" style="padding: 20px; background: rgba(40, 50, 70, 1)">
                    <center><img src="<%= game.get_white_icon %>" width="100px"/></center>
                </div>
                <div class="content">
                  <%= link_to game do %>
                    <div class="header">
                        <h3 style="color:black"><%= game.title %></h3>
                    </div>
                  <% end %>
                  <div class="meta">
                    <%= game.game_type.titleize %>
                  </div>
                  <div class="description">
                    <%= game.get_description %>
                  </div>
                </div>

                <!-- Extra Content -->
                <div class="extra content inverted" style="background:white">
                  <span class="ui left floated">
                    <% if !game.created_at.blank? %>
                      <%= game.created_at.strftime("%B %d") %>
                    <% end %>
                  </span>
                  <span class="ui right floated">
                    <div class="ui button green mini">
                      <i class="pin icon"></i>
                      <% if !game.venue.blank? %>
                        <%= game.venue %>
                      <% end %>
                    </div>
                  </span>
                </div>

                <!-- Extra Content -->
                <% if !game.max_participants.blank? %>
                  <div class="extra content">
                    <span class="ui left floated ">
                        <i class="users icon"></i>
                          <span>
                            <%= game.max_participants.to_i - game.get_participants.count %> Spots Left
                          </span>
                    </span>
                    <% if game.get_participants.count < game.max_participants %>
                      <span class="ui right floated">
                        <% if !game.is_in_game %>
                          <% if game.blank? %>
                            <%= link_to add_person_game_path(game.id, personid: current_person.id), method: :post, class: 'ui button teal mini' do %>
                                <i class="add icon"></i> Join Game
                            <% end %>
                          <% end %>
                        <% end %>
                      </span>
                    <% end %>
                  </div>
                <% end %>

              </div>

            <!-- End Loop-->

          <% end %>
        </div>
    </div>

  </div>


  <br>
</body>
</html>
